!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){var d=a("turf-polygon");b.exports=function(a){var b=[a[0],a[1]],c=[a[0],a[3]],e=[a[2],a[3]],f=[a[2],a[1]],g=d([[b,f,e,c,b]]);return g}},{"turf-polygon":4}],2:[function(a,b,c){var d=a("turf-meta").coordEach;b.exports=function(a){var b=[1/0,1/0,-(1/0),-(1/0)];return d(a,function(a){b[0]>a[0]&&(b[0]=a[0]),b[1]>a[1]&&(b[1]=a[1]),b[2]<a[0]&&(b[2]=a[0]),b[3]<a[1]&&(b[3]=a[1])}),b}},{"turf-meta":3}],3:[function(a,b,c){function d(a,b,c){var d,e,f,g,h,i,j,k,m,n=0,o="FeatureCollection"===a.type,p="Feature"===a.type,q=o?a.features.length:1;for(d=0;d<q;d++)for(k=o?a.features[d].geometry:p?a.geometry:a,m="GeometryCollection"===k.type,i=m?k.geometries.length:1,g=0;g<i;g++)if(h=m?k.geometries[g]:k,j=h.coordinates,n=!c||"Polygon"!==h.type&&"MultiPolygon"!==h.type?0:1,"Point"===h.type)b(j);else if("LineString"===h.type||"MultiPoint"===h.type)for(e=0;e<j.length;e++)b(j[e]);else if("Polygon"===h.type||"MultiLineString"===h.type)for(e=0;e<j.length;e++)for(f=0;f<j[e].length-n;f++)b(j[e][f]);else{if("MultiPolygon"!==h.type)throw new Error("Unknown Geometry Type");for(e=0;e<j.length;e++)for(f=0;f<j[e].length;f++)for(l=0;l<j[e][f].length-n;l++)b(j[e][f][l])}}function e(a,b,c,e){return d(a,function(a){c=b(c,a)},e),c}function f(a,b){var c;switch(a.type){case"FeatureCollection":for(features=a.features,c=0;c<a.features.length;c++)b(a.features[c].properties);break;case"Feature":b(a.properties)}}function g(a,b,c){return f(a,function(a){c=b(c,a)}),c}b.exports.coordEach=d,b.exports.coordReduce=e,b.exports.propEach=f,b.exports.propReduce=g},{}],4:[function(a,b,c){b.exports=function(a,b){if(null===a)throw new Error("No coordinates passed");for(var c=0;c<a.length;c++)for(var d=a[c],e=0;e<d[d.length-1].length;e++){if(d.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(d[d.length-1][e]!==d[0][e])throw new Error("First and last Position are not equivalent.")}var f={type:"Feature",geometry:{type:"Polygon",coordinates:a},properties:b};return f.properties||(f.properties={}),f}},{}],5:[function(a,b,c){var d=a("turf-bbox-polygon"),e=a("turf-extent"),f=a("./defaultParams.js"),g=a("./util/geometryToSimpleGeometries"),h=a("./Viewer"),i=function(a,b){this.dataElement=a,this.settings={},$.extend(!0,this.settings,f,b),this.viewer=new h({techno:this.settings.techno,geometryType:this.settings.geometryType});var c=this.initMap();this.getMap=function(){return c},this.initDrawLayer(),this.settings.editable&&this.initDrawControls(),this.settings.hide&&this.dataElement.hide()};i.prototype.initMap=function(){return this.viewer.initMap({width:this.settings.width,height:this.settings.height,dataElement:this.dataElement,layers:this.settings.tileLayers,lon:this.settings.lon,lat:this.settings.lat,zoom:this.settings.zoom,maxZoom:this.settings.maxZoom,minZoom:this.settings.minZoom})},i.prototype.isDataElementAnInput=function(){return"undefined"!=typeof this.dataElement.val},i.prototype.getRawData=function(){return this.isDataElementAnInput()?$.trim(this.dataElement.val()):$.trim(this.dataElement.html())},i.prototype.setRawData=function(a){var b=this.getRawData();b!==a&&(this.isDataElementAnInput()?this.dataElement.val(a):this.dataElement.html(a))},i.prototype.setGeometry=function(a){a instanceof Array&&4===a.length&&(a=d(a).geometry),this.viewer.removeFeatures(this.featuresCollection);var b=g(a);this.viewer.setGeometries(this.featuresCollection,b),this.settings.centerOnResults&&b.length>0&&this.viewer.fitViewToFeaturesCollection(this.featuresCollection),this.serializeGeometry()},i.prototype.initDrawLayer=function(){this.featuresCollection=this.viewer.createFeaturesCollection(),this.updateDrawLayer(),this.dataElement.on("change",this.updateDrawLayer.bind(this))},i.prototype.updateDrawLayer=function(){var a,b=this.getRawData();if(""!==b)try{a=JSON.parse(b),this.setGeometry(a)}catch(c){return void this.viewer.removeFeatures(this.featuresCollection)}else this.viewer.removeFeatures(this.featuresCollection)},i.prototype.getGeometryType=function(){return this.settings.geometryType},i.prototype.initDrawControls=function(){var a={geometryType:this.getGeometryType(),features:this.featuresCollection};this.viewer.addDrawToolsControl(a);var b={onDrawCreated:function(a){this.settings.centerOnResults&&this.viewer.getFeaturesCount(this.featuresCollection)>0&&this.viewer.fitViewToFeaturesCollection(this.featuresCollection),this.serializeGeometry()}.bind(this),onDrawModified:function(a){this.settings.centerOnResults&&this.viewer.getFeaturesCount(this.featuresCollection)>0&&this.viewer.fitViewToFeaturesCollection(this.featuresCollection),this.serializeGeometry()}.bind(this),onDrawDeleted:function(a){this.serializeGeometry()}.bind(this)};this.viewer.addDrawToolsEvents(b)},i.prototype.serializeGeometry=function(){var a=this.viewer.getGeometryByFeaturesCollection(this.featuresCollection),b="";a&&(b="Rectangle"===this.getGeometryType()?JSON.stringify(e(a)):JSON.stringify(a)),this.settings.onResult(b),this.setRawData(b)},b.exports=i},{"./Viewer":6,"./defaultParams.js":12,"./util/geometryToSimpleGeometries":18,"turf-bbox-polygon":1,"turf-extent":2}],6:[function(a,b,c){(function(c){var d="undefined"!=typeof window?window.ol:"undefined"!=typeof c?c.ol:null,e=a("./controls/DrawToolsControl"),f=a("./util/guid"),g=a("./util/featureCollectionToGeometry.js"),h=a("./util/isSingleGeometryType.js"),i=function(a){this.settings={dataProjection:"EPSG:4326",mapProjection:"EPSG:3857"},$.extend(this.settings,a),this.initMap(this.settings)};i.prototype.initMap=function(a){var b="map-"+f(),c=$('<div id="'+b+'"></div>');c.addClass("map"),c.css("width",a.width),c.css("height",a.height),c.insertAfter(a.dataElement),this.map=this.createMap(b,a),this.addLayersToMap(a.layers)},i.prototype.getMap=function(a){return this.map},i.prototype.addControl=function(a){this.getMap().addControl(a)},i.prototype.createMap=function(a,b){return b=b||{},new d.Map({target:a,view:new d.View({center:d.proj.transform([b.lon,b.lat],this.settings.dataProjection,this.settings.mapProjection),zoom:b.zoom,minZoom:b.minZoom,maxZoom:b.maxZoom,projection:this.settings.mapProjection}),controls:[new d.control.Zoom,new d.control.Attribution]})},i.prototype.addLayersToMap=function(a,b){b=b||{};for(var c in a)this.getMap().addLayer(new d.layer.Tile({source:new d.source.XYZ({attributions:[a[c].attribution],url:a[c].url,crossOrigin:"Anonymous"})}))},i.prototype.setGeometries=function(a,b){for(var c in b){var e;switch(b[c].type){case"Point":e=new d.geom.Point(b[c].coordinates);break;case"LineString":e=new d.geom.LineString(b[c].coordinates);break;case"Polygon":e=new d.geom.Polygon(b[c].coordinates);break;case"MultiPoint":e=new d.geom.MultiPoint(b[c].coordinates);break;case"MultiLineString":e=new d.geom.MultiLineString(b[c].coordinates);break;case"MultiPolygon":e=new d.geom.MultiPolygon(b[c].coordinates)}var f=new d.Feature({geometry:e.transform(this.settings.dataProjection,this.settings.mapProjection)});f.set("type",this.settings.geometryType),a.push(f)}},i.prototype.fitViewToFeaturesCollection=function(a){var b=[];a.forEach(function(a){b.push(a.getGeometry())}),this.getMap().getView().fit(new d.geom.GeometryCollection(b).getExtent(),{size:this.getMap().getSize(),duration:100})},i.prototype.createFeaturesCollection=function(){return new d.Collection},i.prototype.removeFeatures=function(a){a.clear()},i.prototype.getGeometryType=function(){return this.settings.geometryType},i.prototype.addDrawToolsControl=function(a){var b={features:a.features,type:a.geometryType,multiple:!h(a.geometryType)},c=new e(b);this.addControl(c)},i.prototype.addDrawToolsEvents=function(a){this.getMap().on("draw:created",a.onDrawCreated),this.getMap().on("draw:edited",a.onDrawModified),this.getMap().on("draw:deleted",a.onDrawDeleted)},i.prototype.getGeometryByFeaturesCollection=function(a){var b=(new d.format.GeoJSON).writeFeatures(a.getArray(),{featureProjection:this.settings.mapProjection,dataProjection:this.settings.dataProjection});return g(JSON.parse(b))},i.prototype.getFeaturesCount=function(a){return a.getLength()},b.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./controls/DrawToolsControl":8,"./util/featureCollectionToGeometry.js":16,"./util/guid":19,"./util/isSingleGeometryType.js":20}],7:[function(a,b,c){(function(a){var c="undefined"!=typeof window?window.ol:"undefined"!=typeof a?a.ol:null,d=function(a){this.featuresCollection=a.featuresCollection,this.type=a.type||"Point",this.style=a.style,this.multiple=a.multiple;var b=$("<div>").addClass("ol-draw-"+this.type.toLowerCase()+" ol-unselectable ol-control");$("<button>").attr("title","Draw a "+this.type.toLowerCase()).on("touchstart click",function(a){a&&a.preventDefault&&a.preventDefault(),this.setActive(!this.active)}.bind(this)).appendTo(b),c.control.Control.call(this,{element:b.get(0),target:a.target})};c.inherits(d,c.control.Control),d.prototype.setMap=function(a){c.control.Control.prototype.setMap.call(this,a),this.initControl()},d.prototype.initControl=function(){this.addInteraction(),this.active=!1,this.setActive(this.active)},d.prototype.getActive=function(){return this.active},d.prototype.setActive=function(a){this.getInteraction().setActive(a),a&&!this.getActive()&&(this.dispatchEvent("draw:active"),$(this.element).addClass("active"),this.active=!0),!a&&this.getActive()&&(this.dispatchEvent("draw:inactive"),$(this.element).removeClass("active"),this.active=!1)},d.prototype.addInteraction=function(){var a={type:this.type,style:this.style,features:this.featuresCollection};"Square"===this.type&&(a.type="Circle",a.geometryFunction=c.interaction.Draw.createRegularPolygon(4)),"Rectangle"===this.type&&(a.type="Circle",a.geometryFunction=c.interaction.Draw.createBox());var b=new c.interaction.Draw(a);b.on("drawend",function(a){this.multiple||this.featuresCollection.clear(),a.feature.set("type",this.type),a.feature.setStyle(this.style)}.bind(this)),this.featuresCollection.on("add",function(a){this.getMap().dispatchEvent($.extend(a,{type:"draw:created"}))}.bind(this)),this.getInteraction=function(){return b},this.getMap().addInteraction(b)},b.exports=d}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],8:[function(a,b,c){(function(c){var d="undefined"!=typeof window?window.ol:"undefined"!=typeof c?c.ol:null,e=a("./DrawControl"),f=a("./EditControl"),g=a("./TranslateControl"),h=a("./RemoveControl"),i=function(a){var b={features:null,type:"",title:"",multiple:null};this.settings=$.extend(b,a),this.controls=[];var c=$("<div>").addClass("ol-draw-tools ol-unselectable ol-control");d.control.Control.call(this,{element:c.get(0),target:a.target})};d.inherits(i,d.control.Control),i.prototype.setMap=function(a){d.control.Control.prototype.setMap.call(this,a),this.initControl()},i.prototype.initControl=function(){this.addLayer(),this.addDrawControls(),this.addEditControl(),this.addTranslateControl(),this.addRemoveControl()},i.prototype.addLayer=function(){this.settings.features.forEach(function(a){a.setStyle(this.getFeatureStyleByGeometryType(a.getGeometry().getType()))},this);var a=new d.layer.Vector({source:new d.source.Vector({features:this.settings.features})});this.getMap().addLayer(a),this.getLayer=function(){return a}},i.prototype.addDrawControls=function(){"Geometry"!==this.settings.type?this.addDrawControl():(this.addDrawControl({type:"MultiPoint"}),this.addDrawControl({type:"MultiLineString"}),this.addDrawControl({type:"MultiPolygon"}),this.addDrawControl({type:"Rectangle",multiple:!0}))},i.prototype.addDrawControl=function(a){a=a||{};var b=new e({featuresCollection:this.getLayer().getSource().getFeaturesCollection(),type:a.type||this.settings.type,target:this.element,style:this.getFeatureStyleByGeometryType(this.settings.type),multiple:a.multiple||this.settings.multiple});b.on("draw:active",function(){this.deactivateControls(b)}.bind(this)),this.getMap().addControl(b),this.controls.push(b)},i.prototype.addEditControl=function(){var a=new f({featuresCollection:this.getLayer().getSource().getFeaturesCollection(),target:this.element,style:this.getFeatureStyleByGeometryType(this.settings.type)});a.on("edit:active",function(){this.deactivateControls(a)}.bind(this)),this.getMap().addControl(a),this.controls.push(a)},i.prototype.addTranslateControl=function(){var a=new g({featuresCollection:this.getLayer().getSource().getFeaturesCollection(),target:this.element});a.on("translate:active",function(){this.deactivateControls(a)}.bind(this)),this.getMap().addControl(a),this.controls.push(a)},i.prototype.addRemoveControl=function(){var a=new h({featuresCollection:this.getLayer().getSource().getFeaturesCollection(),target:this.element});a.on("remove:active",function(){this.deactivateControls(a)}.bind(this)),this.getMap().addControl(a),this.controls.push(a)},i.prototype.deactivateControls=function(a){this.controls.forEach(function(b){b!==a&&b.setActive(!1)})},i.prototype.getFeatureStyleByGeometryType=function(a){switch(a){case"Point":var b=new d.style.Style({image:new d.style.Icon({anchor:[.5,41],anchorXUnits:"fraction",anchorYUnits:"pixels",opacity:1,src:"../dist/images/marker-icon.png"})}),c=new d.style.Style({image:new d.style.Icon({anchor:[14,41],anchorXUnits:"pixels",anchorYUnits:"pixels",opacity:1,src:"../dist/images/marker-shadow.png"})});return[c,b]}},b.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./DrawControl":7,"./EditControl":9,"./RemoveControl":10,"./TranslateControl":11}],9:[function(a,b,c){(function(c){var d="undefined"!=typeof window?window.ol:"undefined"!=typeof c?c.ol:null,e=a("../interactions/ModifyBoxInteraction"),f=a("../interactions/ModifySquareInteraction"),g=function(a){this.style=a.style,this.featuresCollection=a.featuresCollection;var b=$("<div>").addClass("ol-edit ol-unselectable ol-control");$("<button>").attr("title","Edit a feature").on("touchstart click",function(a){a&&a.preventDefault&&a.preventDefault(),this.setActive(!this.active)}.bind(this)).appendTo(b),d.control.Control.call(this,{element:b.get(0),target:a.target})};d.inherits(g,d.control.Control),g.prototype.setMap=function(a){d.control.Control.prototype.setMap.call(this,a),this.initControl()},g.prototype.initControl=function(){this.addInteractions(),this.active=!1,this.setActive(this.active)},g.prototype.getActive=function(){return this.active},g.prototype.setActive=function(a){this.getInteractions().forEach(function(b){b.setActive(a)}),a&&!this.getActive()&&(this.dispatchEvent("edit:active"),$(this.element).addClass("active"),this.active=!0),!a&&this.getActive()&&(this.dispatchEvent("edit:inactive"),$(this.element).removeClass("active"),this.active=!1)},g.prototype.addInteractions=function(){this.reorganiseFeaturesCollectionByType();var a=new d.interaction.Modify({features:this.getFeaturesCollectionBasic()}),b=new e({features:this.getFeaturesCollectionBox()}),c=new f({features:this.getFeaturesCollectionSquare()});this.getInteractions=function(){return[a,b,c]};var g=function(a){this.getMap().dispatchEvent($.extend(a,{type:"draw:edited"}))}.bind(this);this.getInteractions().forEach(function(a){a.on("modifyend",g),this.getMap().addInteraction(a)}.bind(this))},g.prototype.reorganiseFeaturesCollectionByType=function(){var a=new d.Collection;this.getFeaturesCollectionBasic=function(){return a};var b=new d.Collection;this.getFeaturesCollectionBox=function(){return b};var c=new d.Collection;this.getFeaturesCollectionSquare=function(){return c};var e=function(d){switch(d.get("type")){case"Rectangle":b.push(d);break;case"Square":c.push(d);break;default:a.push(d)}},f=function(d){switch(d.get("type")){case"Rectangle":b.remove(d);break;case"Square":c.remove(d);break;default:a.remove(d)}};this.featuresCollection.forEach(e),this.featuresCollection.on("add",function(a){e(a.element)}),this.featuresCollection.on("remove",function(a){f(a.element)})},b.exports=g}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../interactions/ModifyBoxInteraction":13,"../interactions/ModifySquareInteraction":14}],10:[function(a,b,c){(function(c){var d="undefined"!=typeof window?window.ol:"undefined"!=typeof c?c.ol:null,e=a("../interactions/RemoveInteraction"),f=function(a){this.featuresCollection=a.featuresCollection;var b=$("<div>").addClass("ol-delete ol-unselectable ol-control");$("<button>").attr("title","Remove a feature").on("touchstart click",function(a){a&&a.preventDefault&&a.preventDefault(),this.setActive(!this.active)}.bind(this)).appendTo(b),d.control.Control.call(this,{element:b.get(0),target:a.target})};d.inherits(f,d.control.Control),f.prototype.setMap=function(a){d.control.Control.prototype.setMap.call(this,a),this.initControl()},f.prototype.initControl=function(){this.addInteraction(),this.active=!1,this.setActive(this.active)},f.prototype.getActive=function(){return this.active},f.prototype.setActive=function(a){this.getInteraction().setActive(a),a&&!this.getActive()&&(this.dispatchEvent("remove:active"),$(this.element).addClass("active"),this.active=!0),!a&&this.getActive()&&(this.dispatchEvent("remove:inactive"),$(this.element).removeClass("active"),this.active=!1)},f.prototype.addInteraction=function(){var a=new e({features:this.featuresCollection});this.getInteraction=function(){return a},a.on("deleteend",function(a){this.getMap().dispatchEvent($.extend(a,{type:"draw:deleted"}))}.bind(this)),this.getMap().addInteraction(a)},b.exports=f}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../interactions/RemoveInteraction":15}],11:[function(a,b,c){(function(a){var c="undefined"!=typeof window?window.ol:"undefined"!=typeof a?a.ol:null,d=function(a){this.featuresCollection=a.featuresCollection;var b=$("<div>").addClass("ol-translate ol-unselectable ol-control");$("<button>").attr("title","Remove a feature").on("touchstart click",function(a){a&&a.preventDefault&&a.preventDefault(),this.setActive(!this.active)}.bind(this)).appendTo(b),c.control.Control.call(this,{element:b.get(0),target:a.target})};c.inherits(d,c.control.Control),d.prototype.setMap=function(a){c.control.Control.prototype.setMap.call(this,a),this.initControl()},d.prototype.initControl=function(){this.addInteraction(),this.active=!1,this.setActive(this.active)},d.prototype.getActive=function(){return this.active},d.prototype.setActive=function(a){this.getInteraction().setActive(a),a&&!this.getActive()&&(this.dispatchEvent("translate:active"),$(this.element).addClass("active"),this.active=!0),!a&&this.getActive()&&(this.dispatchEvent("translate:inactive"),$(this.element).removeClass("active"),this.active=!1)},d.prototype.addInteraction=function(){var a=new c.interaction.Translate({features:this.featuresCollection,hitTolerance:10});this.getInteraction=function(){return a},a.on("translateend",function(a){this.getMap().dispatchEvent($.extend(a,{type:"draw:edited"}))}.bind(this)),this.getMap().addInteraction(a)},b.exports=d}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],12:[function(a,b,c){var d={tileLayers:[{url:"http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'Map data Â© <a href="http://openstreetmap.org">OpenStreetMap</a> contributors'}],hide:!0,editable:!0,width:"100%",height:"500",lon:2,lat:45,zoom:4,maxZoom:18,geometryType:"Geometry",centerOnResults:!0,onResult:function(){}};b.exports=d},{}],13:[function(a,b,c){(function(a){var c="undefined"!=typeof window?window.ol:"undefined"!=typeof a?a.ol:null,d=function(a){a=$.extend({features:null},a),c.interaction.Pointer.call(this,{handleDownEvent:d.prototype.handleDownEvent,handleDragEvent:d.prototype.handleDragEvent,handleMoveEvent:d.prototype.handleMoveEvent,handleUpEvent:d.prototype.handleUpEvent}),this.features=a.features,this.coordinate_=null,this.grabCursor_="grab",this.grabbingCursor_="grabbing",this.feature_=null,this.previousCursor_=void 0,this.overlay_=new c.layer.Vector({source:new c.source.Vector({useSpatialIndex:!1,wrapX:!!a.wrapX}),style:a.style,updateWhileAnimating:!0,updateWhileInteracting:!0}),this.overlayPoints_=[]};c.inherits(d,c.interaction.Pointer),d.prototype.handleDownEvent=function(a){this.deltaX=0,this.deltaY=0;var b=this.getFeatureUnderMouse_(a);if(b){this.coordinate_=a.coordinate,this.feature_=b;var c=a.map.getTargetElement();c.style.cursor!==this.grabbingCursor_&&(c.style.cursor=this.grabbingCursor_)}return!!b},d.prototype.handleDragEvent=function(a){var b=this.getFeature_(a);this.deltaX=a.coordinate[0]-this.coordinate_[0],this.deltaY=a.coordinate[1]-this.coordinate_[1],b.getGeometry().translate(this.deltaX,this.deltaY);var c=a.map.getTargetElement();c.style.cursor=this.grabbingCursor_,this.handleModify_(a),this.coordinate_[0]=a.coordinate[0],this.coordinate_[1]=a.coordinate[1]},d.prototype.handleMoveEvent=function(a){var b=this.getFeatureUnderMouse_(a),c=a.map.getTargetElement();b?c.style.cursor!==this.grabCursor_&&(this.previousCursor_=c.style.cursor,c.style.cursor=this.grabCursor_):void 0!==this.previousCursor_&&(c.style.cursor=this.previousCursor_,this.previousCursor_=void 0)},d.prototype.handleUpEvent=function(a){this.deltaX=0,this.deltaY=0;var b=a.map.getTargetElement();return this.feature_?b.style.cursor=this.grabCursor_:b.style.cursor=void 0,this.dispatchEvent({type:"modifyend",feature:this.feature_}),this.coordinate_=null,this.feature_=null,!1},d.prototype.handleModify_=function(a){var b=this.getFeatureOfModifyPoint_(this.feature_);b?this.setFeatureByModifyPoints_(b):this.moveModifyPointsWithFeature_()},d.prototype.setActive=function(a){c.interaction.Pointer.prototype.setActive.call(this,a),a?this.enableModificationPoints(this.features):this.disableModificationPoints(this.features)},d.prototype.enableModificationPoints=function(a){this.getMap().addLayer(this.overlay_),this.overlayPoints_=[],a.forEach(function(a){this.addModificationPoints_(a)}.bind(this))},d.prototype.disableModificationPoints=function(a){this.removeModificationPoints_(a)},d.prototype.removeModificationPoints_=function(a){for(var b in this.overlayPoints_)for(var c in this.overlayPoints_[b].modificationPoints)a.remove(this.overlayPoints_[b].modificationPoints[c]);this.overlay_.getSource().clear(),this.getMap().removeLayer(this.overlay_),this.overlayPoints_=[]},d.prototype.addModificationPoints_=function(a){var b=a.getGeometry().getCoordinates()[0],d=[];for(var e in b)if("4"!==e){var f=new c.Feature({geometry:new c.geom.Point(b[e])});this.overlay_.getSource().addFeature(f),d[e]=f,this.features.push(f)}else d[e]=d[0];this.overlayPoints_.push({feature:a,modificationPoints:d})},d.prototype.getFeatureUnderMouse_=function(a){return a.map.forEachFeatureAtPixel(a.pixel,function(a){for(var b in this.features.getArray())if(this.features.getArray()[b]===a)return a}.bind(this))},d.prototype.getFeature_=function(a){return this.feature_},d.prototype.setFeatureByModifyPoints_=function(a){var b=this.getModifyPointsOfFeature_(a);this.updateLinkedModifyPointForBBox(this.feature_,b),this.redrawFeatureByModificationPointsPosition(a,b)},d.prototype.updateLinkedModifyPointForBBox=function(a,b){var c;for(var d in b)if(a===b[d]){c=parseInt(d);break}var e=c-1,f=c+1;0===c&&(e=3),3===c&&(f=0),c%2!==0?(b[e].getGeometry().translate(0,this.deltaY),b[f].getGeometry().translate(this.deltaX,0)):(b[e].getGeometry().translate(this.deltaX,0),b[f].getGeometry().translate(0,this.deltaY)),b[4].getGeometry().setCoordinates(b[0].getGeometry().getCoordinates())},d.prototype.redrawFeatureByModificationPointsPosition=function(a,b){var c=[];for(var d in b)c.push(b[d].getGeometry().getCoordinates());a.getGeometry().setCoordinates([c])},d.prototype.moveModifyPointsWithFeature_=function(){var a,b=this.getModifyPointsOfFeature_(this.feature_);switch(this.feature_.getGeometry().getType()){case"Polygon":a=this.feature_.getGeometry().getCoordinates()[0],a.pop()}for(var c in a)b[c].getGeometry().setCoordinates(a[c])},d.prototype.getFeatureOfModifyPoint_=function(a){for(var b in this.overlayPoints_)for(var c in this.overlayPoints_[b].modificationPoints)if(this.overlayPoints_[b].modificationPoints[c]===a)return this.overlayPoints_[b].feature},d.prototype.getModifyPointsOfFeature_=function(a){for(var b in this.overlayPoints_)if(this.overlayPoints_[b].feature===a)return this.overlayPoints_[b].modificationPoints},b.exports=d}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],14:[function(a,b,c){(function(a){var c="undefined"!=typeof window?window.ol:"undefined"!=typeof a?a.ol:null,d=function(a){a=$.extend({features:null},a),c.interaction.Pointer.call(this,{handleDownEvent:d.prototype.handleDownEvent,handleDragEvent:d.prototype.handleDragEvent,handleMoveEvent:d.prototype.handleMoveEvent,handleUpEvent:d.prototype.handleUpEvent}),this.features=a.features,this.coordinate_=null,this.grabCursor_="grab",this.grabbingCursor_="grabbing",this.feature_=null,this.previousCursor_=void 0,this.overlay_=new c.layer.Vector({source:new c.source.Vector({useSpatialIndex:!1,wrapX:!!a.wrapX}),style:a.style,updateWhileAnimating:!0,updateWhileInteracting:!0}),this.overlayPoints_=[]};c.inherits(d,c.interaction.Pointer),d.prototype.handleDownEvent=function(a){this.deltaX=0,this.deltaY=0;var b=this.getFeatureUnderMouse_(a);if(b){this.coordinate_=a.coordinate,this.feature_=b;var c=a.map.getTargetElement();c.style.cursor!==this.grabbingCursor_&&(c.style.cursor=this.grabbingCursor_)}return!!b},d.prototype.handleDragEvent=function(a){var b=this.getFeature_(a);this.deltaX=a.coordinate[0]-this.coordinate_[0],this.deltaY=a.coordinate[1]-this.coordinate_[1],b.getGeometry().translate(this.deltaX,this.deltaY);var c=a.map.getTargetElement();c.style.cursor=this.grabbingCursor_,this.handleModify_(a),this.coordinate_[0]=a.coordinate[0],this.coordinate_[1]=a.coordinate[1]},d.prototype.handleMoveEvent=function(a){var b=this.getFeatureUnderMouse_(a),c=a.map.getTargetElement();b?c.style.cursor!==this.grabCursor_&&(this.previousCursor_=c.style.cursor,c.style.cursor=this.grabCursor_):void 0!==this.previousCursor_&&(c.style.cursor=this.previousCursor_,this.previousCursor_=void 0)},d.prototype.handleUpEvent=function(a){this.deltaX=0,this.deltaY=0;var b=a.map.getTargetElement();return this.feature_?b.style.cursor=this.grabCursor_:b.style.cursor=void 0,this.dispatchEvent({type:"modifyend",feature:this.feature_}),this.coordinate_=null,this.feature_=null,!1},d.prototype.handleModify_=function(a){var b=this.getFeatureOfModifyPoint_(this.feature_);b?this.setFeatureByModifyPoints_(b):this.moveModifyPointsWithFeature_()},d.prototype.setActive=function(a){c.interaction.Pointer.prototype.setActive.call(this,a),a?this.enableModificationPoints(this.features):this.disableModificationPoints(this.features)},d.prototype.enableModificationPoints=function(a){this.getMap().addLayer(this.overlay_),this.overlayPoints_=[],a.forEach(function(a){this.addModificationPoints_(a)}.bind(this))},d.prototype.disableModificationPoints=function(a){this.removeModificationPoints_(a)},d.prototype.removeModificationPoints_=function(a){for(var b in this.overlayPoints_)for(var c in this.overlayPoints_[b].modificationPoints)a.remove(this.overlayPoints_[b].modificationPoints[c]);this.overlay_.getSource().clear(),this.getMap().removeLayer(this.overlay_),this.overlayPoints_=[]},d.prototype.addModificationPoints_=function(a){var b=a.getGeometry().getCoordinates()[0],d=[];for(var e in b)if("4"!==e){var f=new c.Feature({geometry:new c.geom.Point(b[e])});this.overlay_.getSource().addFeature(f),d[e]=f,this.features.push(f)}else d[e]=d[0];this.overlayPoints_.push({feature:a,modificationPoints:d})},d.prototype.getFeatureUnderMouse_=function(a){return a.map.forEachFeatureAtPixel(a.pixel,function(a){for(var b in this.features.getArray())if(this.features.getArray()[b]===a)return a}.bind(this))},d.prototype.getFeature_=function(a){return this.feature_},d.prototype.setFeatureByModifyPoints_=function(a){var b=this.getModifyPointsOfFeature_(a);this.updateLinkedModifyPointForBBox(this.feature_,b),this.redrawFeatureByModificationPointsPosition(a,b)},d.prototype.updateLinkedModifyPointForBBox=function(a,b){var c;for(var d in b)if(a===b[d]){c=parseInt(d);break}var e=c-1,f=c+1;0===c&&(e=3),3===c&&(f=0),c%2!==0?(b[e].getGeometry().translate(0,this.deltaY),b[f].getGeometry().translate(this.deltaX,0)):(b[e].getGeometry().translate(this.deltaX,0),b[f].getGeometry().translate(0,this.deltaY)),b[4].getGeometry().setCoordinates(b[0].getGeometry().getCoordinates())},d.prototype.redrawFeatureByModificationPointsPosition=function(a,b){var c=[];for(var d in b)c.push(b[d].getGeometry().getCoordinates());a.getGeometry().setCoordinates([c])},d.prototype.moveModifyPointsWithFeature_=function(){var a,b=this.getModifyPointsOfFeature_(this.feature_);switch(this.feature_.getGeometry().getType()){case"Polygon":a=this.feature_.getGeometry().getCoordinates()[0],a.pop()}for(var c in a)b[c].getGeometry().setCoordinates(a[c])},d.prototype.getFeatureOfModifyPoint_=function(a){for(var b in this.overlayPoints_)for(var c in this.overlayPoints_[b].modificationPoints)if(this.overlayPoints_[b].modificationPoints[c]===a)return this.overlayPoints_[b].feature},d.prototype.getModifyPointsOfFeature_=function(a){for(var b in this.overlayPoints_)if(this.overlayPoints_[b].feature===a)return this.overlayPoints_[b].modificationPoints},b.exports=d}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],15:[function(a,b,c){(function(a){var c="undefined"!=typeof window?window.ol:"undefined"!=typeof a?a.ol:null,d=function(a){a=$.extend({features:null},a),c.interaction.Pointer.call(this,{handleDownEvent:d.prototype.handleDownEvent,handleDragEvent:d.prototype.handleDragEvent,handleMoveEvent:d.prototype.handleMoveEvent,handleUpEvent:d.prototype.handleUpEvent}),this.features=a.features,this.pointerCursor_="pointer",this.feature_=null,this.previousCursor_=void 0};c.inherits(d,c.interaction.Pointer),d.prototype.handleDownEvent=function(a){var b=a.map,c=b.forEachFeatureAtPixel(a.pixel,function(a){for(var b in this.features.getArray())if(this.features.getArray()[b]===a)return a}.bind(this));return this.feature_=c,!!c},d.prototype.handleDragEvent=function(a){var b=a.map,c=b.forEachFeatureAtPixel(a.pixel,function(a){for(var b in this.features.getArray())if(this.features.getArray()[b]===a)return a}.bind(this)),d=a.map.getTargetElement();c?d.style.cursor!=this.pointerCursor_&&(this.previousCursor_=d.style.cursor,d.style.cursor=this.pointerCursor_):void 0!==this.previousCursor_&&(d.style.cursor=this.previousCursor_,this.previousCursor_=void 0)},d.prototype.handleMoveEvent=function(a){var b=a.map,c=b.forEachFeatureAtPixel(a.pixel,function(a){for(var b in this.features.getArray())if(this.features.getArray()[b]===a)return a}.bind(this)),d=a.map.getTargetElement();c?d.style.cursor!=this.pointerCursor_&&(this.previousCursor_=d.style.cursor,d.style.cursor=this.pointerCursor_):void 0!==this.previousCursor_&&(d.style.cursor=this.previousCursor_,this.previousCursor_=void 0)},d.prototype.handleUpEvent=function(a){var b=a.map,c=(b.forEachFeatureAtPixel(a.pixel,function(a){for(var b in this.features.getArray())this.features.getArray()[b]===a&&this.feature_===a&&this.features.remove(a)}.bind(this)),b.forEachFeatureAtPixel(a.pixel,function(a){for(var b in this.features.getArray())if(this.features.getArray()[b]===a)return a;
}.bind(this))),d=a.map.getTargetElement();return c?d.style.cursor=this.pointerCursor_:void 0!==d.style.cursor&&(d.style.cursor=void 0),this.dispatchEvent({type:"deleteend"}),!1},b.exports=d}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],16:[function(a,b,c){var d=a("./geometriesToCollection.js"),e=function(a){var b=[];return a.features.forEach(function(a){b.push(a.geometry)}),0===b.length?null:1==b.length?b[0]:d(b)};b.exports=e},{"./geometriesToCollection.js":17}],17:[function(a,b,c){var d=function(a){var b={};a.forEach(function(a){"undefined"==typeof b[a.type]?b[a.type]=1:b[a.type]++});var c=Object.keys(b);if(c.length>1)return{type:"GeometryCollection",geometries:a};var d="Multi"+Object.keys(b)[0],e=[];return a.forEach(function(a){e.push(a.coordinates)}),{type:d,coordinates:e}};b.exports=d},{}],18:[function(a,b,c){var d=function(a){var b=[],c=a.type.substring("Multi".length);return a.coordinates.forEach(function(a){b.push({type:c,coordinates:a})}),b},e=function(a){var b=[];return a.geometries.forEach(function(a){b.push(a)}),b},f=function(a){switch(a.type){case"Point":case"LineString":case"Polygon":return[a];case"MultiPoint":case"MultiLineString":case"MultiPolygon":return d(a);case"GeometryCollection":return e(a);default:throw"unsupported geometry type : "+a.type}};b.exports=f},{}],19:[function(a,b,c){var d=function(){function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()};b.exports=d},{}],20:[function(a,b,c){var d=function(a){return["Point","LineString","Polygon","Rectangle"].indexOf(a)!==-1};b.exports=d},{}],21:[function(a,b,c){(function(b){var c="undefined"!=typeof window?window.jQuery:"undefined"!=typeof b?b.jQuery:null,d={defaultParams:a("./ge/defaultParams"),GeometryEditor:a("./ge/GeometryEditor")};c.fn.geometryEditor=function(a){return this.each(function(){var b=$(this),c=new d.GeometryEditor(b,a);b.data("editor",c)})},b.ge=d}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./ge/GeometryEditor":5,"./ge/defaultParams":12}]},{},[21]);